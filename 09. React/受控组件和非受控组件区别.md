# æœ‰çŠ¶æ€ç»„ä»¶&æ— çŠ¶æ€ç»„ä»¶&å—æ§ç»„ä»¶&éå—æ§ç»„ä»¶



## **æœ‰çŠ¶æ€ç»„ä»¶å’Œæ— çŠ¶æ€ç»„ä»¶**

å®šä¹‰ï¼šâ€ƒæ— çŠ¶æ€ç»„ä»¶å†…éƒ¨æ²¡æœ‰ `state` ï¼Œå…¶æ‰§è¡Œç»“æœå®Œå…¨ä¾èµ–äº `props` çš„å†…å®¹ã€‚

â€ƒâ€ƒä¹‹å‰å‡½æ•°ç»„ä»¶åŸºæœ¬éƒ½æ˜¯éçŠ¶æ€ç»„ä»¶ï¼Œå‡½æ•°ç»„ä»¶å¦‚ä¸‹ä¾‹:

```js
const funcComponent = (props) => {
  const {title} = props;

  return (
    <div>
      {title}
    </div>
  )
}
```

â€‹	åæ¥ï¼Œ`react-hooks` è®©å‡½æ•°ç»„ä»¶ä¹Ÿèƒ½å¤Ÿå¦‚åŒ `class` ç»„ä»¶ä¸€æ ·æ‹¥æœ‰è‡ªå·±çš„ `state` ç­‰åŠŸèƒ½ã€‚

â€ƒ

## [å—æ§ç»„ä»¶](https://zh-hans.reactjs.org/docs/forms.html#controlled-components) vs [éå—æ§ç»„ä»¶](https://zh-hans.reactjs.org/docs/uncontrolled-components.html)

React æœ‰ä¸¤ç§ä¸åŒçš„æ–¹å¼æ¥å¤„ç†è¡¨å•è¾“å…¥ã€‚

å¦‚æœä¸€ä¸ª input è¡¨å•å…ƒç´ çš„å€¼æ˜¯ç”± React æ§åˆ¶ï¼Œå°±å…¶ç§°ä¸º*å—æ§ç»„ä»¶*ã€‚å½“ç”¨æˆ·å°†æ•°æ®è¾“å…¥åˆ°å—æ§ç»„ä»¶æ—¶ï¼Œä¼šè§¦å‘ä¿®æ”¹çŠ¶æ€çš„äº‹ä»¶å¤„ç†å™¨ï¼Œè¿™æ—¶ç”±ä½ çš„ä»£ç æ¥å†³å®šæ­¤è¾“å…¥æ˜¯å¦æœ‰æ•ˆï¼ˆå¦‚æœæœ‰æ•ˆå°±ä½¿ç”¨æ›´æ–°åçš„å€¼é‡æ–°æ¸²æŸ“ï¼‰ã€‚å¦‚æœä¸é‡æ–°æ¸²æŸ“ï¼Œåˆ™è¡¨å•å…ƒç´ å°†ä¿æŒä¸å˜ã€‚

ä¸€ä¸ª*éå—æ§ç»„ä»¶*ï¼Œå°±åƒæ˜¯è¿è¡Œåœ¨ React ä½“ç³»ä¹‹å¤–çš„è¡¨å•å…ƒç´ ã€‚å½“ç”¨æˆ·å°†æ•°æ®è¾“å…¥åˆ°è¡¨å•å­—æ®µï¼ˆä¾‹å¦‚ inputï¼Œdropdown ç­‰ï¼‰æ—¶ï¼ŒReact ä¸éœ€è¦åšä»»ä½•äº‹æƒ…å°±å¯ä»¥æ˜ å°„æ›´æ–°åçš„ä¿¡æ¯ã€‚ç„¶è€Œï¼Œè¿™ä¹Ÿæ„å‘³ç€ï¼Œä½ æ— æ³•å¼ºåˆ¶ç»™è¿™ä¸ªè¡¨å•å­—æ®µè®¾ç½®ä¸€ä¸ªç‰¹å®šå€¼ã€‚

åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ åº”è¯¥ä½¿ç”¨å—æ§ç»„ä»¶ã€‚





æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨`React`ä¸­å®šä¹‰äº†ä¸€ä¸ª`input`è¾“å…¥æ¡†çš„è¯ï¼Œå®ƒå¹¶æ²¡æœ‰ç±»ä¼¼äº`Vue`é‡Œ`v-model`çš„è¿™ç§åŒå‘ç»‘å®šåŠŸèƒ½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ä¸€ä¸ªæŒ‡ä»¤èƒ½å¤Ÿå°†æ•°æ®å’Œè¾“å…¥æ¡†ç»“åˆèµ·æ¥ï¼Œç”¨æˆ·åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥å†…å®¹ï¼Œç„¶åæ•°æ®åŒæ­¥æ›´æ–°ã€‚

å°±åƒä¸‹é¢è¿™ä¸ªæ¡ˆä¾‹ï¼š

```jsx
class TestComponent extends React.Component {
  render () {
    return <input name="username" />
  }
}
å¤åˆ¶ä»£ç 
```

ç”¨æˆ·åœ¨ç•Œé¢ä¸Šçš„è¾“å…¥æ¡†è¾“å…¥å†…å®¹æ—¶ï¼Œå®ƒæ˜¯è‡ªå·±ç»´æŠ¤äº†ä¸€ä¸ª`"state"`ï¼Œè¿™æ ·çš„è¯å°±èƒ½æ ¹æ®ç”¨æˆ·çš„è¾“å…¥è‡ªå·±è¿›è¡Œ`UI`ä¸Šçš„æ›´æ–°ã€‚(è¿™ä¸ª`state`å¹¶ä¸æ˜¯æˆ‘ä»¬å¹³å¸¸çœ‹è§çš„`this.state`ï¼Œè€Œæ˜¯æ¯ä¸ªè¡¨å•å…ƒç´ ä¸ŠæŠ½è±¡çš„`state`)

æƒ³æƒ³æ­¤æ—¶å¦‚æœæˆ‘ä»¬æƒ³è¦æ§åˆ¶è¾“å…¥æ¡†çš„å†…å®¹å¯ä»¥æ€æ ·åšå‘¢ï¼Ÿå””...è¾“å…¥æ¡†çš„å†…å®¹å–å†³çš„æ˜¯`input`ä¸­çš„`value`å±æ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨`this.state`ä¸­å®šä¹‰ä¸€ä¸ªåä¸º`username`çš„å±æ€§ï¼Œå¹¶å°†`input`ä¸Šçš„`value`æŒ‡å®šä¸ºè¿™ä¸ªå±æ€§ï¼š

```jsx
class TestComponent extends React.Component {
  constructor (props) {
    super(props);
    this.state = { username: 'lindaidai' };
  }
  render () {
    return <input name="username" value={this.state.username} />
  }
}
å¤åˆ¶ä»£ç 
```

ä½†æ˜¯è¿™æ—¶å€™ä½ ä¼šå‘ç°`input`çš„å†…å®¹æ˜¯åªè¯»çš„ï¼Œå› ä¸º`value`ä¼šè¢«æˆ‘ä»¬çš„`this.state.username`æ‰€æ§åˆ¶ï¼Œå½“ç”¨æˆ·è¾“å…¥æ–°çš„å†…å®¹æ—¶ï¼Œ`this.state.username`å¹¶ä¸ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œè¿™æ ·çš„è¯`input`å†…çš„å†…å®¹ä¹Ÿå°±ä¸ä¼šå˜äº†ã€‚

å“ˆå“ˆï¼Œä½ å¯èƒ½å·²ç»æƒ³åˆ°äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ª`onChange`äº‹ä»¶æ¥ç›‘å¬è¾“å…¥å†…å®¹çš„æ”¹å˜å¹¶ä½¿ç”¨`setState`æ›´æ–°`this.state.username`ï¼š

```jsx
class TestComponent extends React.Component {
  constructor (props) {
    super(props);
    this.state = {
      username: "lindaidai"
    }
  }
  onChange (e) {
    console.log(e.target.value);
    this.setState({
      username: e.target.value
    })
  }
  render () {
    return <input name="username" value={this.state.username} onChange={(e) => this.onChange(e)} />
  }
}
å¤åˆ¶ä»£ç 
```

ç°åœ¨ä¸è®ºç”¨æˆ·è¾“å…¥ä»€ä¹ˆå†…å®¹`state`ä¸`UI`éƒ½ä¼šè·Ÿç€æ›´æ–°äº†ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥åœ¨ç»„ä»¶ä¸­çš„å…¶å®ƒåœ°æ–¹ä½¿ç”¨`this.state.username`æ¥è·å–åˆ°`input`é‡Œçš„å†…å®¹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡`this.setState()`æ¥ä¿®æ”¹`input`é‡Œçš„å†…å®¹ã€‚

OKğŸ‘Œï¼Œç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹çœ‹**å—æ§ç»„ä»¶**çš„å®šä¹‰ï¼š

åœ¨HTMLçš„è¡¨å•å…ƒç´ ä¸­ï¼Œå®ƒä»¬é€šå¸¸è‡ªå·±ç»´æŠ¤ä¸€å¥—`state`ï¼Œå¹¶éšç€ç”¨æˆ·çš„è¾“å…¥è‡ªå·±è¿›è¡Œ`UI`ä¸Šçš„æ›´æ–°ï¼Œè¿™ç§è¡Œä¸ºæ˜¯ä¸è¢«æˆ‘ä»¬ç¨‹åºæ‰€ç®¡æ§çš„ã€‚è€Œå¦‚æœå°†`React`é‡Œçš„`state`å±æ€§å’Œè¡¨å•å…ƒç´ çš„å€¼å»ºç«‹ä¾èµ–å…³ç³»ï¼Œå†é€šè¿‡`onChange`äº‹ä»¶ä¸`setState()`ç»“åˆæ›´æ–°`state`å±æ€§ï¼Œå°±èƒ½è¾¾åˆ°æ§åˆ¶ç”¨æˆ·è¾“å…¥è¿‡ç¨‹ä¸­è¡¨å•å‘ç”Ÿçš„æ“ä½œã€‚è¢«`React`ä»¥è¿™ç§æ–¹å¼æ§åˆ¶å–å€¼çš„è¡¨å•è¾“å…¥å…ƒç´ å°±å«åš**å—æ§ç»„ä»¶**ã€‚

(é¢ï¼Œå‘†å‘†è®¤ä¸ºä¸Šé¢ğŸ‘†è¿™ä¸ªæ€»ç»“å°±å¯ä»¥ç”¨åœ¨é¢è¯•å½“ä¸­äº†)



## **PureComponent**

â€ƒâ€ƒPureComponent ä¸ Component å¾ˆç›¸ä¼¼ï¼Œä¸¤è€…åŒºåˆ«åœ¨äº PureComponent ä»¥**æµ…å±‚å¯¹æ¯” props å’Œ state çš„æ–¹å¼**å®ç°äº† `shouldComponentUpdate` å‡½æ•°ã€‚

**åªæ¯”è¾ƒå¯¹è±¡çš„ç¬¬ä¸€çº§ , å¦‚æœå±æ€§å€¼æ˜¯åŸºæœ¬ç±»å‹çš„ï¼Œæˆ‘ä»¬åªéœ€è¦æ¯”è¾ƒå€¼æ˜¯å¦ä¸€æ ·å³å¯**

â€ƒâ€ƒå¦‚æœèµ‹äºˆ React ç»„ä»¶ç›¸åŒçš„ props å’Œ stateï¼Œ`render` å‡½æ•°å°±ä¼šæ¸²æŸ“ç›¸åŒçš„å†…å®¹ï¼Œé‚£ä¹ˆåœ¨æŸäº›æƒ…å†µä¸‹ä½¿ç”¨ PureComponent å¯æé«˜æ€§èƒ½ã€‚

>æ³¨æ„:
>
>`React.PureComponent` ä¸­çš„ `shouldComponentUpdate()` ä»…ä½œå¯¹è±¡çš„æµ…å±‚æ¯”è¾ƒã€‚å¦‚æœå¯¹è±¡ä¸­åŒ…å«å¤æ‚çš„æ•°æ®ç»“æ„ï¼Œåˆ™æœ‰å¯èƒ½å› ä¸ºæ— æ³•æ£€æŸ¥æ·±å±‚çš„å·®åˆ«ï¼Œäº§ç”Ÿé”™è¯¯çš„æ¯”å¯¹ç»“æœã€‚ä»…åœ¨ä½ çš„ props å’Œ state è¾ƒä¸ºç®€å•æ—¶ï¼Œæ‰ä½¿ç”¨ `React.PureComponent`ï¼Œæˆ–è€…åœ¨æ·±å±‚æ•°æ®ç»“æ„å‘ç”Ÿå˜åŒ–æ—¶è°ƒç”¨ [`forceUpdate()`](https://zh-hans.reactjs.org/docs/react-component.html#forceupdate) æ¥ç¡®ä¿ç»„ä»¶è¢«æ­£ç¡®åœ°æ›´æ–°ã€‚ä½ ä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨ [immutable å¯¹è±¡](https://facebook.github.io/immutable-js/)åŠ é€ŸåµŒå¥—æ•°æ®çš„æ¯”è¾ƒã€‚
>
>æ­¤å¤–ï¼Œ`React.PureComponent` ä¸­çš„ `shouldComponentUpdate()` å°†è·³è¿‡æ‰€æœ‰å­ç»„ä»¶æ ‘çš„ prop æ›´æ–°ã€‚å› æ­¤ï¼Œè¯·ç¡®ä¿æ‰€æœ‰å­ç»„ä»¶ä¹Ÿéƒ½æ˜¯â€œçº¯â€çš„ç»„ä»¶ã€‚

